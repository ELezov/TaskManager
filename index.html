<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Task Manager — Liquid Glass</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <a href="#main-content" class="skip-link">Перейти к контенту</a>
  <div class="app">
    <header class="header">
      <h1 class="header__title">Task Manager</h1>
      <div class="header__actions">
        <div class="header__inbox-wrap">
          <button type="button" class="btn btn--ghost header__inbox-btn" id="btn-inbox-quick" aria-label="Быстро в инбокс">+ В инбокс</button>
          <span class="inbox-badge" id="inbox-badge" aria-live="polite" hidden>0</span>
          <button type="button" class="btn btn--primary header__empty-inbox-btn" id="btn-empty-inbox" aria-label="Опустошить инбокс" disabled>Опустошить инбокс</button>
          <div class="inbox-quick glass glass--elevated" id="inbox-quick-popover" hidden role="dialog" aria-label="Добавить в инбокс">
            <input type="text" class="input inbox-quick__input" id="inbox-quick-input" placeholder="Надо бы… или идея" autocomplete="off">
            <button type="button" class="btn btn--primary inbox-quick__btn" id="inbox-quick-submit">В инбокс</button>
          </div>
        </div>
        <label class="focus-switcher">
          <input type="checkbox" class="focus-switcher__input" id="focus-mode" aria-label="Режим фокуса: скрыть сферы и бэклог">
          <span class="focus-switcher__track" aria-hidden="true">
            <span class="focus-switcher__thumb"></span>
          </span>
          <span class="focus-switcher__label">Фокус</span>
        </label>
        <button type="button" class="btn btn--primary" id="btn-open-triggers" aria-label="Спусковые крючки">Спусковые крючки</button>
        <button type="button" class="btn btn--ghost" id="btn-open-calendar" aria-label="Календарь">Календарь</button>
        <button type="button" class="btn btn--ghost header__settings" id="btn-open-settings" aria-label="Настройки">⚙</button>
      </div>
    </header>

    <div class="tabs glass" id="tabs-wrap" role="tablist" aria-label="Сферы">
      <div class="tabs__list" id="tabs-list"></div>
      <button type="button" class="btn btn--ghost tabs__add" id="btn-add-sphere" aria-label="Добавить сферу">+ Сфера</button>
    </div>

    <div class="sphere-content">
      <section class="sphere-notes glass" aria-label="Заметки сферы">
        <h2 class="sphere-notes__title">Заметки сферы</h2>
        <div class="notes-list" id="sphere-notes-list"></div>
        <div class="note-form">
          <textarea class="textarea note-form__input" id="sphere-note-text" placeholder="Добавить заметку к сфере..." rows="2"></textarea>
          <button type="button" class="btn btn--primary note-form__btn" id="btn-add-sphere-note">Добавить заметку</button>
        </div>
      </section>

      <aside class="board-tip glass" id="board-tip" aria-label="Подсказка">
        <p class="board-tip__text" id="board-tip-text">Тяжёлые по мысленной нагрузке задачи лучше делать блоками в наиболее ресурсное время дня.</p>
      </aside>
      <main id="main-content" class="board" role="main">
        <section class="column glass" data-status="backlog">
          <h2 class="column__title">Backlog</h2>
          <div class="column__cards" data-column="backlog"></div>
          <button type="button" class="btn btn--ghost column__add" data-status="backlog">+ Добавить задачу</button>
        </section>
        <section class="column glass" data-status="todo">
          <h2 class="column__title">Todo</h2>
          <div class="column__cards" data-column="todo"></div>
          <button type="button" class="btn btn--ghost column__add" data-status="todo">+ Добавить задачу</button>
        </section>
        <section class="column glass" data-status="in-progress">
          <h2 class="column__title">In Progress</h2>
          <div class="column__cards" data-column="in-progress"></div>
          <button type="button" class="btn btn--ghost column__add" data-status="in-progress">+ Добавить задачу</button>
        </section>
        <section class="column glass" data-status="done">
          <h2 class="column__title">Done</h2>
          <div class="column__cards" data-column="done"></div>
          <button type="button" class="btn btn--ghost column__add" data-status="done">+ Добавить задачу</button>
        </section>
      </main>
    </div>
  </div>

  <!-- Оверлей «Спусковые крючки» — граф поверх рабочей области -->
  <div class="triggers-overlay" id="triggers-overlay" role="dialog" aria-modal="true" aria-labelledby="triggers-overlay-title" hidden>
    <div class="triggers-overlay__backdrop" id="triggers-overlay-backdrop"></div>
    <div class="triggers-overlay__content glass glass--elevated">
      <div class="triggers-overlay__header">
        <button type="button" class="btn btn--ghost triggers-overlay__back" id="triggers-overlay-back" aria-label="К выбору раздела" hidden>← Раздел</button>
        <h2 id="triggers-overlay-title" class="triggers-overlay__title">Спусковые крючки для очистки мозга</h2>
        <p class="triggers-overlay__subtitle" id="triggers-overlay-subtitle">Выберите раздел — откроется список триггеров. Клик по пункту: добавить задачу в сферу.</p>
        <button type="button" class="btn btn--ghost triggers-overlay__close" id="triggers-overlay-close" aria-label="Закрыть">&times;</button>
      </div>
      <div class="triggers-overlay__choose" id="triggers-choose">
        <button type="button" class="triggers-choose__card glass" data-section-id="zdorovie">Здоровье</button>
        <button type="button" class="triggers-choose__card glass" data-section-id="semya">Семья</button>
        <button type="button" class="triggers-choose__card glass" data-section-id="dom-dacha">Дом / дача</button>
        <button type="button" class="triggers-choose__card glass" data-section-id="lichnaya-zhizn">Личная жизнь</button>
        <button type="button" class="triggers-choose__card glass" data-section-id="ucheba">Учёба</button>
        <button type="button" class="triggers-choose__card glass" data-section-id="rabota">Работа</button>
      </div>
      <div class="triggers-overlay__content-wrap" id="triggers-content-wrap" hidden>
        <div class="triggers-list" id="triggers-list"></div>
      </div>
      <div class="triggers-overlay__popover" id="triggers-popover" hidden role="dialog" aria-label="Добавить задачу в сферу">
        <div class="triggers-popover__inner" id="triggers-popover-inner">
          <p class="triggers-popover__label" id="triggers-popover-label">Категория</p>
          <input type="text" class="input triggers-popover__input" id="triggers-popover-input" placeholder="Что пришло в голову?">
          <select class="input triggers-popover__select" id="triggers-popover-sphere"></select>
          <button type="button" class="btn btn--primary triggers-popover__btn" id="triggers-popover-btn">В сферу</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Режим «Опустошить инбокс»: по одной записи, 4 действия + таймер + счётчик дней -->
  <div class="inbox-empty-overlay" id="inbox-empty-overlay" role="dialog" aria-modal="true" aria-labelledby="inbox-empty-title" hidden>
    <div class="inbox-empty__backdrop" id="inbox-empty-backdrop"></div>
    <div class="inbox-empty__content glass glass--elevated">
      <div class="inbox-empty__header">
        <h2 id="inbox-empty-title" class="inbox-empty__title">Опустошить инбокс</h2>
        <button type="button" class="btn btn--ghost inbox-empty__close" id="inbox-empty-close" aria-label="Закрыть">&times;</button>
      </div>
      <p class="inbox-empty__microtip" id="inbox-empty-microtip" aria-live="polite" hidden></p>
      <div class="inbox-empty__timer" id="inbox-empty-timer" aria-live="polite"></div>
      <div class="inbox-empty__streak" id="inbox-empty-streak" aria-live="polite"></div>
      <div class="inbox-empty__card" id="inbox-empty-card">
        <p class="inbox-empty__text" id="inbox-empty-text"></p>
        <p class="inbox-empty__counter" id="inbox-empty-counter" aria-live="polite"></p>
        <div class="inbox-empty__actions">
          <button type="button" class="btn btn--primary inbox-empty__action" id="inbox-empty-to-task" data-action="task">В задачу</button>
          <button type="button" class="btn btn--ghost inbox-empty__action" id="inbox-empty-to-note" data-action="note">В заметку</button>
          <button type="button" class="btn btn--ghost inbox-empty__action" id="inbox-empty-to-calendar" data-action="calendar">В календарь</button>
          <button type="button" class="btn btn--ghost inbox-empty__action inbox-empty__action--danger" id="inbox-empty-to-trash" data-action="trash">В мусор</button>
        </div>
      </div>
      <div class="inbox-empty__done" id="inbox-empty-done" hidden>
        <p class="inbox-empty__done-title">Инбокс пуст!</p>
        <p class="inbox-empty__done-streak" id="inbox-empty-done-streak"></p>
        <button type="button" class="btn btn--primary" id="inbox-empty-done-close">Закрыть</button>
      </div>
    </div>
  </div>

  <!-- Календарь: задачи по срокам из всех сфер -->
  <div class="calendar-overlay" id="calendar-overlay" role="dialog" aria-modal="true" aria-labelledby="calendar-overlay-title" hidden>
    <div class="calendar-overlay__backdrop" id="calendar-overlay-backdrop"></div>
    <div class="calendar-overlay__content glass glass--elevated">
      <div class="calendar-overlay__header">
        <button type="button" class="btn btn--ghost calendar-overlay__nav" id="calendar-prev" aria-label="Предыдущий месяц">‹</button>
        <h2 id="calendar-overlay-title" class="calendar-overlay__title"></h2>
        <button type="button" class="btn btn--ghost calendar-overlay__nav" id="calendar-next" aria-label="Следующий месяц">›</button>
        <button type="button" class="btn btn--ghost calendar-overlay__close" id="calendar-close" aria-label="Закрыть">&times;</button>
      </div>
      <div class="calendar-grid" id="calendar-grid" role="grid" aria-label="Календарь месяца"></div>
      <div class="calendar-day-tasks" id="calendar-day-tasks">
        <h3 class="calendar-day-tasks__title" id="calendar-day-tasks-title">Выберите день</h3>
        <ul class="calendar-day-tasks__list" id="calendar-day-tasks-list"></ul>
      </div>
    </div>
  </div>

  <!-- Сравнение задач при импорте (текущая vs загружаемая) -->
  <div class="modal compare-modal" id="modal-task-compare" role="dialog" aria-modal="true" aria-labelledby="compare-modal-title" hidden>
    <div class="modal__backdrop" id="compare-modal-backdrop"></div>
    <div class="modal__content compare-modal__content glass glass--elevated">
      <div class="modal__header">
        <h2 id="compare-modal-title" class="modal__title">Задача уже есть — сравнение</h2>
        <button type="button" class="btn btn--ghost modal__close" id="compare-modal-close" aria-label="Закрыть">&times;</button>
      </div>
      <div class="compare-modal__body">
        <div class="compare-panel compare-panel--current">
          <h3 class="compare-panel__title">Текущая</h3>
          <dl class="compare-panel__list" id="compare-current-list"></dl>
        </div>
        <div class="compare-panel compare-panel--imported">
          <h3 class="compare-panel__title">Загружаемая</h3>
          <dl class="compare-panel__list" id="compare-imported-list"></dl>
        </div>
      </div>
      <div class="modal__footer compare-modal__footer">
        <button type="button" class="btn btn--primary" id="compare-keep-current">Оставить текущую</button>
        <button type="button" class="btn btn--ghost" id="compare-replace">Заменить загруженной</button>
      </div>
    </div>
  </div>

  <!-- Виджет настроек (шестерёнка) -->
  <div class="settings-overlay" id="settings-overlay" role="dialog" aria-modal="true" aria-labelledby="settings-overlay-title" hidden>
    <div class="settings-overlay__backdrop" id="settings-overlay-backdrop"></div>
    <div class="settings-overlay__content glass glass--elevated">
      <div class="settings-overlay__header">
        <h2 id="settings-overlay-title" class="settings-overlay__title">Настройки</h2>
        <button type="button" class="btn btn--ghost settings-overlay__close" id="settings-overlay-close" aria-label="Закрыть">&times;</button>
      </div>
      <div class="settings-overlay__body">
        <p class="settings-overlay__section-label">Задачи и сферы (JSON)</p>
        <div class="settings-overlay__actions">
          <button type="button" class="btn btn--primary" id="btn-export" aria-label="Выгрузить задачи в JSON">Выгрузить JSON</button>
          <label class="btn btn--ghost" for="input-import">Загрузить JSON</label>
          <input type="file" id="input-import" accept=".json" class="sr-only" aria-label="Выберите JSON файл">
        </div>
      </div>
    </div>
  </div>

  <!-- Modal: Task detail -->
  <div class="modal" id="modal-task" role="dialog" aria-modal="true" aria-labelledby="modal-task-title" hidden>
    <div class="modal__backdrop" data-close="modal-task"></div>
    <div class="modal__content glass glass--elevated">
      <div class="modal__header">
        <h2 id="modal-task-title" class="modal__title">Задача</h2>
        <button type="button" class="btn btn--ghost modal__close" data-close="modal-task" aria-label="Закрыть">&times;</button>
      </div>
      <div class="modal__body">
        <div class="task-detail">
          <div class="task-detail__field">
            <label class="task-detail__label">Название</label>
            <input type="text" class="input task-detail__input" id="detail-title" placeholder="Название задачи">
          </div>
          <div class="task-detail__field">
            <label class="task-detail__label">Описание</label>
            <textarea class="textarea task-detail__textarea" id="detail-description" placeholder="Описание (необязательно)" rows="3"></textarea>
          </div>
          <div class="task-detail__field">
            <label class="task-detail__label">Срок исполнения</label>
            <input type="date" class="input" id="detail-due-date" placeholder="Не задан">
          </div>
          <div class="task-detail__field">
            <label class="task-detail__label">Приоритет</label>
            <select class="input task-detail__select" id="detail-priority">
              <option value="low">Низкий</option>
              <option value="medium">Средний</option>
              <option value="high">Высокий</option>
              <option value="critical">Критикал</option>
            </select>
          </div>
          <div class="task-detail__field">
            <label class="task-detail__label">Мысленная тяжесть</label>
            <select class="input task-detail__select" id="detail-mental-weight">
              <option value="light">Лёгкая</option>
              <option value="medium">Средняя</option>
              <option value="heavy">Тяжёлая</option>
            </select>
          </div>
          <div class="task-detail__field">
            <label class="task-detail__label">Статус</label>
            <select class="input task-detail__select" id="detail-status">
              <option value="backlog">Backlog</option>
              <option value="todo">Todo</option>
              <option value="in-progress">In Progress</option>
              <option value="done">Done</option>
            </select>
          </div>
          <div class="task-detail__subtasks" id="task-detail-subtasks" hidden>
            <p class="task-detail__subtasks-summary" id="task-detail-subtasks-summary" aria-live="polite"></p>
            <h3 class="task-detail__subtasks-title">Первый шажок</h3>
            <p class="task-detail__subtasks-hint">Микро-действия: один тап — один шажок.</p>
            <ul class="subtasks-list" id="subtasks-list"></ul>
            <div class="subtasks-add">
              <input type="text" class="input subtasks-add__input" id="subtask-input" placeholder="Что сделать первым?" autocomplete="off">
              <button type="button" class="btn btn--primary subtasks-add__btn" id="btn-add-subtask">Добавить шажок</button>
            </div>
          </div>
          <div class="task-detail__notes">
            <h3 class="task-detail__notes-title">Заметки к задаче</h3>
            <div class="notes-list" id="notes-list"></div>
            <div class="note-form">
              <textarea class="textarea note-form__input" id="note-text" placeholder="Добавить заметку..." rows="2"></textarea>
              <button type="button" class="btn btn--primary note-form__btn" id="btn-add-note">Добавить заметку</button>
            </div>
          </div>
        </div>
      </div>
      <div class="modal__footer">
        <button type="button" class="btn btn--ghost" id="btn-delete-task">Удалить задачу</button>
        <button type="button" class="btn btn--primary" id="btn-save-task">Сохранить</button>
      </div>
    </div>
  </div>

  <!-- Modal: Add task -->
  <div class="modal" id="modal-add" role="dialog" aria-modal="true" aria-labelledby="modal-add-title" hidden>
    <div class="modal__backdrop" data-close="modal-add"></div>
    <div class="modal__content glass glass--elevated">
      <div class="modal__header">
        <h2 id="modal-add-title" class="modal__title">Новая задача</h2>
        <button type="button" class="btn btn--ghost modal__close" data-close="modal-add" aria-label="Закрыть">&times;</button>
      </div>
      <div class="modal__body">
        <div class="task-detail">
          <div class="task-detail__field">
            <label class="task-detail__label">Название</label>
            <input type="text" class="input task-detail__input" id="add-title" placeholder="Название задачи">
          </div>
          <div class="task-detail__field">
            <label class="task-detail__label">Описание</label>
            <textarea class="textarea task-detail__textarea" id="add-description" placeholder="Описание (необязательно)" rows="3"></textarea>
          </div>
          <div class="task-detail__field">
            <label class="task-detail__label">Срок исполнения</label>
            <input type="date" class="input" id="add-due-date">
          </div>
          <div class="task-detail__field">
            <label class="task-detail__label">Приоритет</label>
            <select class="input task-detail__select" id="add-priority">
              <option value="low">Низкий</option>
              <option value="medium">Средний</option>
              <option value="high">Высокий</option>
              <option value="critical">Критикал</option>
            </select>
          </div>
          <div class="task-detail__field">
            <label class="task-detail__label">Мысленная тяжесть</label>
            <select class="input task-detail__select" id="add-mental-weight">
              <option value="light">Лёгкая</option>
              <option value="medium">Средняя</option>
              <option value="heavy">Тяжёлая</option>
            </select>
          </div>
          <div class="task-detail__field">
            <label class="task-detail__label">Статус</label>
            <select class="input task-detail__select" id="add-status">
              <option value="backlog">Backlog</option>
              <option value="todo">Todo</option>
              <option value="in-progress">In Progress</option>
              <option value="done">Done</option>
            </select>
          </div>
        </div>
      </div>
      <div class="modal__footer">
        <button type="button" class="btn btn--ghost" data-close="modal-add">Отмена</button>
        <button type="button" class="btn btn--primary" id="btn-create-task">Создать</button>
      </div>
    </div>
  </div>

  <!-- Modal: Add sphere -->
  <div class="modal" id="modal-add-sphere" role="dialog" aria-modal="true" aria-labelledby="modal-add-sphere-title" hidden>
    <div class="modal__backdrop" data-close="modal-add-sphere"></div>
    <div class="modal__content glass glass--elevated">
      <div class="modal__header">
        <h2 id="modal-add-sphere-title" class="modal__title">Новая сфера</h2>
        <button type="button" class="btn btn--ghost modal__close" data-close="modal-add-sphere" aria-label="Закрыть">&times;</button>
      </div>
      <div class="modal__body">
        <div class="task-detail">
          <div class="task-detail__field">
            <label class="task-detail__label">Название сферы</label>
            <input type="text" class="input task-detail__input" id="add-sphere-name" placeholder="Например: Учёба, Здоровье">
          </div>
        </div>
      </div>
      <div class="modal__footer">
        <button type="button" class="btn btn--ghost" data-close="modal-add-sphere">Отмена</button>
        <button type="button" class="btn btn--primary" id="btn-create-sphere">Создать</button>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
